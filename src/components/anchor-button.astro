---
import { Icon } from "astro-icon"
import { twMerge } from "tailwind-merge"

export interface Props {
    href: string
    label: string
    isExternal?: boolean
    exact?: boolean
}
const { href, label, isExternal = false, exact = false } = Astro.props

const pathname = new URL(Astro.request.url).pathname

const externalLinkProps = isExternal
    ? {
          target: "_blank",
          rel: "noopener noreferrer",
      }
    : {}

const getActiveState = () => {
    const pathnames = Astro.url.pathname.split("/")

    if (exact) {
        if (pathnames[2] === "") {
            return true
        } else {
            return false
        }
    } else {
        return pathname.includes(href)
    }
}
---

<a
    {href}
    {...externalLinkProps}
    class={twMerge(
        "rounded p-2 transition hover:bg-dark-5 hover:dark:bg-dark-9 group",
        getActiveState() ? "bg-dark-6 dark:bg-dark-8 flex space-x-1" : ""
    )}
>
    <span
        class={twMerge(
            "text-sm group-hover:text-dark-1 transition font-semibold tracking-wide",
            getActiveState() ? "text-dark-1" : "text-dark-4"
        )}
    >
        {label}
    </span>
    {isExternal && <Icon name="uil:arrow-up-right" class="h-3 w-3" />}
</a>
